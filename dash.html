<!DOCTYPE html>
<meta charset="utf-8">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Drata</title>

    <link rel="stylesheet" type="text/css" href="content/style/core/normalize.css" />
    <link rel="stylesheet" type="text/css" href="content/style/core/foundation.css" />
    <link rel="stylesheet" type="text/css" href="content/style/dashboard.css" />
    <link rel="stylesheet" type="text/css" href="content/style/segment.css" />
    <link rel="stylesheet" type="text/css" href="content/style/chart.css" />
    <link rel="stylesheet" type="text/css" href="content/style/combobox.css" />
    <link rel="stylesheet" type="text/css" href="content/style/core/general_foundicons.css" />

    <style>
        #previewgraph {
            height: 300px;
        }
        
    </style>
</head>
<body>
    <nav class="top-bar dashboard" id="topbar" data-topbar style="margin-bottom:1rem">
        <ul class="title-area">
            <li class="name">
                <h1><a href="#">Drata</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
        </ul>

        <section class="top-bar-section">
            <!-- Right Nav Section -->
            <ul class="right">
                <li class="divider"></li>
                <li class="has-form">
                    <a data-bind="click:addWidget" class="button success"><i class="general foundicon-plus"></i>&nbsp;Add Widget</a>
                </li>
                
            </ul>

            <!-- Left Nav Section -->
            <ul class="left">
            </ul>
        </section>
    </nav>
    <div id="dashboard" class="row js-sortable" data-bind="template:{ name: 'widget-template',foreach:widgets, afterRender:loadWidget }">
    </div>
    <div id="graphBuilder" class="mymodal-wrapper">
        <div class="mymodal-inner">
            <nav class="top-bar" id="topbar" data-topbar>
                <ul class="title-area">
                    <li class="name">
                        <h1><a href="#">Widget Processor</a></h1>
                    </li>
                    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
                </ul>

                <section class="top-bar-section">
                    <!-- Right Nav Section -->
                    <ul class="right">
                        <li class="divider"></li>
                        <li class="has-form">
                            <a data-bind="click:preview" class="button">
                                <i class="general foundicon-graph"></i>&nbsp;Preview</a>
                        </li>
                        <li class="divider"></li>
                        <li class="has-form">
                            <a data-bind="click:notifyWidget" class="button success">
                                <i class="general foundicon-plus"></i>
                                <!-- ko text:addUpdateBtnText -->
                                <!-- /ko -->
                            </a>
                        </li>

                        <li class="divider"></li>
                        <li class="has-form">
                            <a data-bind="click:widgetCancel" class="button alert"><i class="general foundicon-remove"></i></a>
                        </li>
                    </ul>

                    <!-- Left Nav Section -->
                    <ul class="left">
                    </ul>
                </section>
            </nav>
            
            <div class="row">
                <div class="medium-12 large-6 columns">
                    <fieldset data-bind="visible:previewGraph">
                        <legend>Preview</legend>
                        <div id="previewgraph">
                            <svg></svg>
                        </div>
                    </fieldset>
                    
                </div>
                <div class="medium-12 large-6 columns">
                    <fieldset>
                        <legend>Data Key</legend>
                        <div class="row">
                            <div class="small-4 columns">
                                <label class="right inline">Select Data Key</label>
                            </div>
                            <div class="small-8 columns">
                                <select data-bind="options:dataKeys, optionsCaption: 'choose key', value:selectedDataKey"></select>
                            </div>
                        </div>
                    </fieldset>
                    <!-- ko template: {name: 'segment-template', data: segment} -->
                    <!-- /ko -->
                </div>
            </div>


            <div class="row">
                <div class="small-12 columns">
                    <button class="button success" data-bind="click:preview">Preview</button>
                    &nbsp;
                    <button data-bind="click:notifyWidget,text:addUpdateBtnText"></button>
                    &nbsp;
                    <button class="button secondary" data-bind="click:widgetCancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/html" id="widget-template">
    <div class="widget-outer" data-bind="css: widgetClass">
        <div class="widget-wrapper">
            <nav class="top-bar secondary widget handle" id="topbar" data-topbar>
                <ul class="title-area">
                    <li class="name">
                        <h1><a data-bind="html:name"></a></h1>
                    </li>
                    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
                </ul>
                <section class="top-bar-section">
                    <ul class="right">
                        <li class="divider"></li>
                        <li>
                        <select data-bind="value:sizex">
                            <option value="1">25%</option>
                            <option value="2">50%</option>
                            <option value="3">75%</option>
                            <option value="4">100%</option>
                            <option value="5">33.3%</option>
                            <option value="6">66.6%</option>
                        </select>
                        </li>
                        <li class="divider"></li>
                        <li class="has-form action-icon">
                            <i data-bind="click:$parent.deleteWidget" class="general foundicon-remove"></i>
                        </li>
                        <li class="divider"></li>
                        <li class="has-form action-icon">
                            <i data-bind="click:editWidget" class="general foundicon-edit"></i>
                        </li>
                    </ul>
                    <ul class="left">
                    </ul>

                </section>
            </nav>
            <!-- ko template: contentTemplate() -->
            <!-- /ko -->
        </div>
        </div>
    </script>
    <script type="text/html" id="content-template">
        <div data-bind="attr :{id: widgetContentId}" class="widget-content">
            <svg></svg>
        </div>
    </script>
    <script type="text/html" id="pie-content-template">
        <div style="position:relative">
        <div data-bind="attr :{id: widgetContentId}" class="widget-content">
            <svg></svg>
        </div>
        <select style="position:absolute; right: 0;top: -.09rem;width:auto" data-bind="options:pieKeys, value:selectedPieKey, visible:pieKeys().length > 1"></select>
            </div>
        
    </script>
    <script type="text/html" id="segment-template">
    
        <div class="row">
            <div class="large-12 columns">
                <!-- ko template: {name: 'selection-template', data: selection} -->
                <!-- /ko -->
                <!-- ko template: {name: 'group-template', data: group} -->
                <!-- /ko -->

                <ul class="small-block-grid-2 segment-type" data-bind="visible: $root.newWidget">
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'line','secondary': chartType() !== 'line'},click:setChartType.bind(this, 'line')">
                            <i class="general foundicon-plus"></i>
                            <p>LineChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'pie','secondary': chartType() !== 'pie'},click:setChartType.bind(this, 'pie')">
                            <i class="general foundicon-plus"></i>
                            <p>PieChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'area','secondary': chartType() !== 'area'},click:setChartType.bind(this, 'area')">
                            <i class="general foundicon-plus"></i>
                            <p>AreaChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'bar','secondary': chartType() !== 'bar'},click:setChartType.bind(this, 'bar')">
                            <i class="general foundicon-plus"></i>
                            <p>Bar Chart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'scatter','secondary': chartType() !== 'scatter'},click:setChartType.bind(this, 'scatter')">
                            <i class="general foundicon-plus"></i>
                            <p>ScatterChart</p>
                        </span>
                    </li>
                </ul>

                <!-- ko template: {name : 'datagroup-template', data : dataGroup} -->
                <!-- /ko -->
            </div>
        </div>

    </script>
    <script type="text/html" id="selection-template">
        <div class="row">
            <div class="large-12 columns">
                <fieldset>
                    <legend>Selections 
                    <span class="label" data-bind="click: addSimpleSelection"><i class="general foundicon-plus"></i>Simple</span>&nbsp;
                    <span class="label success" data-bind="click: addComplexSelection"><i class="general foundicon-plus"></i>Complex</span>
                    </legend>

                    <ul class="small-block-grid-3" data-bind="foreach: props">
                        <li>
                            <div class="row collapse">
                                <div class="small-10 columns">
                                    <select data-bind="options: $parents[1].properties, value:prop"></select>
                                </div>
                                <div class="small-2 columns">
                                    <i class="general foundicon-remove remove-condition" data-bind="click:$parent.removeSimpleSelection"></i>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <!-- ko template: {name: 'group-template', foreach: complexGroups} -->
                    <!-- /ko -->
                </fieldset>
            </div>
        </div>
    </script>
    <script type="text/html" id="datagroup-template">
        <div class="row">
            <div class="small-12 columns">
                <fieldset>
                    <legend>Grouping</legend>
                    <form>
                        <!-- ko if:$parent.chartType() === 'pie' || $parent.chartType() === 'bar' -->
                        <div class="row">
                            <div class="small-4 columns">
                                <select data-bind="value:groupBy, optionsCaption : 'grouping'">
                                    <option value="sumBy">Sum By</option>
                                    <option value="countBy">Count By</option>
                                    <option value="groupValuesBy">Group Selection By</option>
                                    <option value="count">Compare Counts</option>
                                    <option value="sum">Compare Sum</option>
                                </select>
                            </div>
                            <div class="small-8 columns">
                                <select data-bind="options:$parent.properties, value:groupByProp, visible:hasGrouping"></select>
                            </div>
                        </div>
                        <!-- /ko -->
                        <!-- ko if:$parent.chartType() === 'line' || $parent.chartType() === 'area'|| $parent.chartType() === 'scatter'  -->
                        <div class="row">
                            <div class="small-8">
                                <div class="row">
                                    <div class="small-4 columns">
                                        <label class="right inline">x Axis</label>
                                    </div>
                                    <div class="small-8 columns">
                                        <select data-bind="options:$parent.properties, value:xAxisProp"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="small-4 columns">
                                        <label class="right inline">
                                            <input type="checkbox" data-bind="checked:hasGrouping" />
                                            &nbsp;Group by</label>
                                    </div>
                                    <div class="small-8 columns">
                                        <select data-bind="options:$parent.properties, visible:hasGrouping, value:groupByProp"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="small-4 columns">
                                        <label class="right inline">
                                            <input type="checkbox" data-bind="checked:timeseries" />
                                            TimeSeries</label>
                                    </div>
                                    <div class="small-8 columns">
                                        <!-- ko if: timeseries -->
                                        <div class="row">
                                            <div class="small-6 columns">
                                                <select data-bind="options:$parent.groupingOptions, value:groupBy"></select>
                                            </div>
                                            <div class="small-6 columns">
                                                <input type="text" data-bind="value:interval" placeholder="Interval" />
                                            </div>
                                        </div>
                                        <!-- /ko -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /ko -->
                    </form>
                </fieldset>
            </div>
        </div>
    </script>
    <script type="text/html" id="group-template">
        <div class="row collapse" style="position: relative">
            <!-- ko if: $parent.groups-->
            <div class="columns logic-toggler">
                <div class="logic-wrapper" data-bind="visible: !amIFirst()">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:(groupType === 'conditions')?$parents[level].logics : $parents[level].arithmeticOperations, optionsCaption:'logic', value: logic"></select>
                </div>
            </div>
            <!-- /ko -->
            <div data-bind="css: ($parent.groups) ? 'operation-group columns' : 'small-12 columns'">
                <!-- ko if: !editMode() -->
                <div class="condition-view">
                    <span class="keystroke" data-bind="text:expression,click: expand"></span>
                </div>
                <!-- /ko -->
                <!-- ko if: editMode() -->
                <fieldset class="segment">
                    <legend>
                        <span data-bind="text: groupTypeName"></span>
                        <span class="label" data-bind="click: addGroup"><i class="general foundicon-plus"></i>Group</span>&nbsp;
                <span class="label success" data-bind="click: addCondition"><i class="general foundicon-plus"></i><span data-bind="text:conditionTypeName"></span></span>
                        <i class="general foundicon-remove remove-group" data-bind="click: $parent.removeGroup, visible : $parent.groups ||  groupType === 'selections'"></i>
                        <i style="color: #d5d5d5" class="general foundicon-up-arrow" data-bind="click: collapse, visible : editMode() && groupType !== 'selections'"></i>
                        <!-- ko if: !$parent.groups && groupType === 'selections' && $parent.conditionType !== 'conditions' -->
                        &nbsp;<input class="input-elem" type="text" data-bind="value:selectionName" placeholder="Selection Name" />
                        <!-- /ko -->

                    </legend>
                    <!-- ko template: {name: getTemplate, foreach: groups} -->
                    <!-- /ko -->
                </fieldset>
                <!-- /ko -->
            </div>
        </div>

    </script>
    <script type="text/html" id="condition-template">
        <div class="row collapse" style="position: relative">
            <i style="position: absolute; right: -17px; top: 8px; color: #d5d5d5" class="general foundicon-up-arrow" data-bind="click: collapse, visible:editMode"></i>
            <div class="columns logic-toggler">
                <div class="logic-wrapper" data-bind="visible: !amIFirst()">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:$parents[level].logics, optionsCaption:'logic', value: logic"></select>
                </div>
            </div>
            <div class="operation-group columns">
                <!-- ko if: !editMode() -->
                <div class="condition-view">
                    <span class="keystroke" data-bind="text:expression,click: expand"></span>
                </div>
                <!-- /ko -->

                <!-- ko if: editMode() -->
                <div class="row collapse" data-bind="visible : !isComplex()">
                    <div class="small-5 columns">
                        <select data-bind="options:$parents[level].properties, optionsCaption:'property', value: prop"></select>
                    </div>
                    <div class="small-2 columns">
                        <select style="margin-left: -1px" data-bind="options:$parents[level].conditionalOperations, value: operation"></select>
                    </div>
                    <div class="small-5 columns">
                        <input type="text" style="margin-left: -2px" data-bind="value:value" placeholder="value"></input>
                    </div>
                </div>
                <!-- ko if: isComplex() -->
                <!-- ko template: {name: 'group-template', data: selectionGroup} -->
                <!-- /ko -->
                <!-- /ko -->
                <div class="row collapse">
                    <div class="small-5 columns">
                        <input type="checkbox" data-bind="checked:isComplex" />
                        Complex
                    </div>
                    <!-- ko if: isComplex() -->

                    <div class="small-3 columns">
                        <select data-bind="options:$parents[level].conditionalOperations, optionsCaption:'Operation', value: operation"></select>
                    </div>
                    <div class="small-3 columns">
                        <input type="text" data-bind="value:value" placeholder="custom value" style="margin-left: -1px"></input>
                    </div>
                    <div class="small-1 columns">
                        <i style="color: #ff0000" class="general foundicon-remove remove-condition" data-bind="click:$parent.removeCondition"></i>
                    </div>
                    <!-- /ko -->

                </div>
                <!-- /ko -->
            </div>
        </div>

    </script>

    <script type="text/html" id="operation-template">
        <div class="row collapse">
            <div class="columns logic-toggler">
                <!-- ko if: $parent.groups && $parent.groups.indexOf($data) > 0 -->
                <div class="logic-wrapper">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:$parents[level].arithmeticOperations, optionsCaption:'logic', value: logic"></select>
                </div>
                <!-- /ko -->
            </div>
            <div class="operation-group columns">
                <div class="row collapse">
                    <div class="small-10 columns" data-bind="comboBox :{selectedValue: prop, options:$parents[level].properties,optionsCaption:'choose Property'}">
                        // <select data-bind="options:$parents[level].properties, optionsCaption:'choose Property', value: prop"></select>
                    </div>
                    <div class="small-2 columns">
                        <i class="general foundicon-remove remove-condition" data-bind="click:$parent.removeCondition"></i>
                    </div>
                </div>
            </div>
        </div>
    </script>


    <script type="text/javascript" src="content/js/utils.js"></script>
    <script type="text/javascript" src="content/js/lib/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="content/js/lib/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="content/js/lib/d3.v3.js"></script>

    
    <script type="text/javascript" src="content/js/sortable.js"></script>

    <script type="text/javascript" src="content/js/lib/knockout-2.2.1.js"></script>
    <script type="text/javascript" src="content/js/lib/helpers/ko.extensions.js"></script>
    <script type="text/javascript" src="content/js/lib/helpers/ko.custombindinghandlers.js"></script>

    <script type="text/javascript" src="content/js/lib/underscore-min.js"></script>
    <script type="text/javascript" src="content/foundation/js/foundation/foundation.js"></script>
    <script type="text/javascript" src="content/foundation/js/foundation/foundation.topbar.js"></script>

    <script type="text/javascript" src="content/js/models/axis.js"></script>
    <script type="text/javascript" src="content/js/models/dots.js"></script>
    <script type="text/javascript" src="content/js/models/labels.js"></script>
    <script type="text/javascript" src="content/js/models/lines.js"></script>
    <script type="text/javascript" src="content/js/models/area.js"></script>
    <script type="text/javascript" src="content/js/models/tooltip.js"></script>
    <script type="text/javascript" src="content/js/charts/linechart.js"></script>
    <script type="text/javascript" src="content/js/charts/areachart.js"></script>

    <script type="text/javascript" src="content/js/segment.js"></script>
    <script type="text/javascript" src="content/js/dashboardmodel.js"></script>
    <script type="text/javascript" src="content/js/dashboard.js"></script>
    <script type="text/javascript" src="content/js/charts/pie.js"></script>

    <script type="text/javascript" src="content/js/charts/barchart.js"></script>
    <script type="text/javascript" src="content/js/charts/scatterplot.js"></script>
   
    <script type="text/javascript" src="content/js/tempdata.js"></script>
   
    <script type="text/javascript">
        (function (root, $) {
            window.dashboard = new Dashboard();
            ko.applyBindings(dashboard, document.getElementById('dashboard'));
            window.topBar = new TopBar();
            ko.applyBindings(topBar, document.getElementById('topbar'));

            window.widgetProcessor = new WidgetProcessor();
            ko.applyBindings(widgetProcessor, document.getElementById('graphBuilder'));
            $(document).foundation();
        })(this, jQuery);
    </script>
</body>
</html>
