<!DOCTYPE html>
<meta charset="utf-8">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

    <link rel="stylesheet" type="text/css" href="/style/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/style/app.css" />
    <link rel="stylesheet" type="text/css" href="/style/fonts/general_foundicons.css" />
    <link rel="stylesheet" type="text/css" href="/style/chart.css" />
    <link rel="stylesheet" type="text/css" href="/style/numeric-chart.css" />
    <link rel="stylesheet" type="text/css" href="/style/segment.css" />
    <link rel="stylesheet" type="text/css" href="/style/combobox.css" />
    <link rel="stylesheet" type="text/css" href="/style/smoothness/jquery-ui-1.10.4.custom.css" />
   
</head>
<body>
<div id="mfcalc">
    <div class="row" style="margin-top:2rem;">
        <div class="small-4 small-offset-2 columns">
            <input type="text" data-bind="value: s" placeholder="Amount To Me"></input>
        </div>
        
        <div class="small-4 columns">
            <!-- ko text: total() -->
            <!-- /ko -->
        </div>
    </div>
</div>



    <script type="text/javascript" src="/js/lib/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/js/lib/jquery-ui-1.10.4.custom.min.js"></script>

    <script type="text/javascript" src="/js/lib/knockout-3.0.0.js"></script>
     <script type="text/javascript" src="/js/lib/knockout.validation.min.js"></script>
    <script type="text/javascript" src="/js/helpers/ko.extensions.js"></script>
    <script type="text/javascript" src="/js/helpers/ko.custombindinghandlers.js"></script>

    <script type="text/javascript" src="/js/helpers/ko.validation.extensions.js"></script>

    <script type="text/javascript" src="/js/lib/underscore-min.js"></script>
    <script type="text/javascript" src="/js/foundation.js"></script>


    <script type="text/javascript">

    window.ps = [16.49,15.99,15.49,14.99,14.49,.99];
    window.breakdown = 500;
            
    window.getP = function(s){
        var tt = s / breakdown;
        var t1 = Math.floor(tt);
        var t2 = tt - t1;
        var ret = 0, p;
        for(var i=0;i< t1;i++){
            var j = Math.min(i, ps.length -1);
            ret = ret + ((ps[j]/100) * breakdown);
        }
        var f = Math.min(t1, ps.length -1);
        ret = ret + ((ps[f]/100) * t2 * breakdown);
        return ret;
    }
        var MfCalc = function(){
            var self = this;
            self.s = ko.observable();
            self.total = ko.computed(function(){
                var s = +self.s();
                if(!s) return "--";
                var initial = getP(s);
                console.log(initial);
                var fucked = getP(s + initial);
                console.log(fucked);
                return '$' + (s + fucked).toFixed(2);
            });
        }
        window.mfcalc = new MfCalc();
        ko.applyBindings(window.mfcalc, document.getElementById('mfcalc'));
    </script>
    
</body>
</html>









