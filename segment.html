<!DOCTYPE html>
<meta charset="utf-8">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

    <link rel="stylesheet" type="text/css" href="content/style/core/normalize.css" />
    <link rel="stylesheet" type="text/css" href="content/style/core/foundation.css" />
    <link rel="stylesheet" type="text/css" href="content/style/core/general_foundicons.css" />
    <link rel="stylesheet" type="text/css" href="content/style/chart.css" />
    <link rel="stylesheet" type="text/css" href="content/style/segment.css" />
    <link rel="stylesheet" type="text/css" href="content/style/combobox.css" />
    
    <style>
        
       
        .graph {
            height:200px;
        }

    </style>
</head>
<body>
    <div>
        <div class="row" id="segmentProcessor">
            <div class="large-6 columns">
                <div class="row">
                    <div class="small-12 columns">
                        <div id="graph" class="graph">
                            <svg></svg>
                        </div>
                    </div>
                </div>
                <div class="row">
                        <button data-bind="click: process" class="button small">process</button>
                </div>
                <div class="row">
                    <div class="large-12 columns">
                    <h6>Output</h6>
                        <textarea style="height:300px" data-bind="text:outputData"></textarea>
                        <h6>Input</h6>
                        <textarea style="height:300px" data-bind="text:rawData"></textarea>
                        
                        
                    </div>
                </div>
            </div>
            <div class="large-6 columns">
                <!-- ko template: {name: 'segment-template', data: segment} -->
                <!-- /ko -->
            </div>
        </div>
    </div>



    <script type="text/html" id="segment-template">
    
        <div class="row">
            <div class="large-12 columns">
                <!-- ko template: {name: 'selection-template', data: selection} -->
                <!-- /ko -->
                <!-- ko template: {name: 'group-template', data: group} -->
                <!-- /ko -->

                <ul class="small-block-grid-2 segment-type" data-bind="visible: $root.newWidget">
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'line','secondary': chartType() !== 'line'},click:setChartType.bind(this, 'line')">
                            <i class="general foundicon-plus"></i>
                            <p>LineChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'pie','secondary': chartType() !== 'pie'},click:setChartType.bind(this, 'pie')">
                            <i class="general foundicon-plus"></i>
                            <p>PieChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'area','secondary': chartType() !== 'area'},click:setChartType.bind(this, 'area')">
                            <i class="general foundicon-plus"></i>
                            <p>AreaChart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'bar','secondary': chartType() !== 'bar'},click:setChartType.bind(this, 'bar')">
                            <i class="general foundicon-plus"></i>
                            <p>Bar Chart</p>
                        </span>
                    </li>
                    <li>
                        <span class="label radius" data-bind="css: {'primary': chartType() === 'scatter','secondary': chartType() !== 'scatter'},click:setChartType.bind(this, 'scatter')">
                            <i class="general foundicon-plus"></i>
                            <p>ScatterChart</p>
                        </span>
                    </li>
                </ul>

                <!-- ko template: {name : 'datagroup-template', data : dataGroup} -->
                <!-- /ko -->
            </div>
        </div>

    </script>
    <script type="text/html" id="selection-template">
        <div class="row">
            <div class="large-12 columns">
                <fieldset>
                    <legend>Selections 
                    <span class="label" data-bind="click: addSimpleSelection"><i class="general foundicon-plus"></i>Simple</span>&nbsp;
                    <span class="label success" data-bind="click: addComplexSelection"><i class="general foundicon-plus"></i>Complex</span>
                    </legend>

                    <ul class="small-block-grid-3" data-bind="foreach: props">
                        <li>
                            <div class="row collapse">
                                <div class="small-11 columns" data-bind="ddComboBox :{selectedPrefix: groupBy , prefixOptions: $parents[1].groupingOptions ,selectedValue: prop, options:$parents[1].properties,optionsCaption:'choose Property', allowCustom:false}">
                                </div>
                               
                                <div class="small-1 columns">
                                    <i class="general foundicon-remove remove-condition" data-bind="click:$parent.removeSimpleSelection"></i>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <!-- ko template: {name: 'group-template', foreach: complexGroups} -->
                    <!-- /ko -->
                </fieldset>
            </div>
        </div>
    </script>
    <script type="text/html" id="datagroup-template">
        <div class="row">
            <div class="small-12 columns">
                <fieldset>
                    <legend>Grouping</legend>
                        <div class="row">
                            <div class="small-8">
                                <div class="row">
                                    <div class="small-4 columns">
                                        <label class="right inline">
                                            <input type="checkbox" data-bind="checked:hasGrouping" />
                                            &nbsp;Group by</label>
                                    </div>
                                    <div class="small-8 columns">
                                        <select data-bind="enable: hasGrouping, value:groupByProp, options:$parent.properties, optionsCaption : 'Select GroupBy'">
                                        </select>
                                    </div>
                                </div>

                                <!-- ko if:($parent.chartType() === 'pie' || $parent.chartType() === 'bar') && hasGrouping -->
                                <div class="row">
                                    <div class="small-4 columns">
                                        <label class="right inline">
                                        <input type="checkbox" data-bind="checked:hasDivideBy" /> Slice by</label>
                                    </div>
                                    <div class="small-8 columns">
                                        <select data-bind="enable: hasDivideBy,options:$parent.properties, value:divideByProp, optionsCaption: 'Slice GroupBy'"></select>
                                    </div>
                                </div>

                                <!-- /ko -->
                                <!-- ko if:$parent.chartType() === 'line' || $parent.chartType() === 'area'|| $parent.chartType() === 'scatter'  -->
                                    <div class="row">
                                        <div class="small-4 columns">
                                            <label class="right inline">x Axis</label>
                                        </div>
                                    
                                        <div class="small-8 columns" data-bind="ddComboBox :{selectedPrefix: xAxisType , prefixOptions: $parent.xAxisTypes,selectedValue: xAxisProp, options:$parent.properties,optionsCaption:'x Axis', allowCustom:false}">
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="small-4 columns">
                                            <label class="right inline">
                                                <input type="checkbox" data-bind="checked:timeseries" />
                                                TimeSeries</label>
                                        </div>
                                        <div class="small-8 columns">
                                            <input type="text" data-bind="enable:timeseries,value:interval" placeholder="Interval" />
                                        </div>
                                    </div>
                                <!-- /ko -->
                            </div>
                        </div>
                </fieldset>
            </div>
        </div>
    </script>
    <script type="text/html" id="group-template">
    
        <div class="row collapse" style="position: relative">
            <!-- ko if: $parent.groups-->
            <div class="columns logic-toggler">
                <div class="logic-wrapper" data-bind="visible: !amIFirst()">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:(groupType === 'conditions')?$parents[level].logics : $parents[level].arithmeticOperations, optionsCaption:'logic', value: logic"></select>
                </div>
            </div>
            <!-- /ko -->
            <div data-bind="css: ($parent.groups) ? 'operation-group columns' : 'small-12 columns'">
                <!-- ko if: !editMode() -->
                <div class="condition-view">
                    <span class="keystroke" data-bind="text:expression,click: expand"></span>
                </div>
                <!-- /ko -->
                <!-- ko if: editMode() -->
                <fieldset class="segment">
                    <legend>
                        <span data-bind="text: groupTypeName"></span>
                        <span class="label" data-bind="click: addGroup"><i class="general foundicon-plus"></i>Group</span>&nbsp;
                <span class="label success" data-bind="click: addCondition"><i class="general foundicon-plus"></i><span data-bind="text:conditionTypeName"></span></span>
                        <i class="general foundicon-remove remove-group" data-bind="click: $parent.removeGroup, visible : $parent.groups ||  groupType === 'selections'"></i>
                        <i style="color: #d5d5d5" class="general foundicon-up-arrow" data-bind="click: collapse, visible : editMode() && groupType !== 'selections'"></i>
                        <!-- ko if: !$parent.groups && groupType === 'selections' && $parent.conditionType !== 'conditions' -->
                        &nbsp;<input class="input-elem" type="text" data-bind="value:selectionName" placeholder="Selection Name" />
                        &nbsp;<select style="width:auto" data-bind="options: $parents[level].groupingOptions", value : groupBy"></select>
                        <!-- /ko -->

                    </legend>
                    <!-- ko template: {name: getTemplate, foreach: groups} -->
                    <!-- /ko -->
                </fieldset>
                <!-- /ko -->
            </div>
        </div>

    </script>
    <script type="text/html" id="condition-template">
        <div class="row collapse" style="position: relative">
            <i style="position: absolute; right: -17px; top: 8px; color: #d5d5d5" class="general foundicon-up-arrow" data-bind="click: collapse, visible:editMode"></i>
            <div class="columns logic-toggler">
                <div class="logic-wrapper" data-bind="visible: !amIFirst()">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:$parents[level].logics, optionsCaption:'logic', value: logic"></select>
                </div>
            </div>
            <div class="operation-group columns">
                <!-- ko if: !editMode() -->
                <div class="condition-view">
                    <span class="keystroke" data-bind="text:expression,click: expand"></span>
                </div>
                <!-- /ko -->

                <!-- ko if: editMode() -->
                <div class="row collapse" data-bind="visible : !isComplex()">
                    <div class="small-5 columns">
                        <select data-bind="options:$parents[level].properties, optionsCaption:'property', value: prop"></select>
                    </div>
                    <div class="small-2 columns">
                        <select style="margin-left: -1px" data-bind="options:$parents[level].conditionalOperations, value: operation"></select>
                    </div>
                    <div class="small-5 columns">
                        <input type="text" style="margin-left: -2px" data-bind="value:value" placeholder="value"></input>
                    </div>
                </div>
                <!-- ko if: isComplex() -->
                <!-- ko template: {name: 'group-template', data: selectionGroup} -->
                <!-- /ko -->
                <!-- /ko -->
                <div class="row collapse">
                    <div class="small-5 columns">
                        <input type="checkbox" data-bind="checked:isComplex" />
                        Complex
                    </div>
                    <!-- ko if: isComplex() -->

                    <div class="small-3 columns">
                        <select data-bind="options:$parents[level].conditionalOperations, optionsCaption:'Operation', value: operation"></select>
                    </div>
                    <div class="small-3 columns">
                        <input type="text" data-bind="value:value" placeholder="custom value" style="margin-left: -1px"></input>
                    </div>
                    <div class="small-1 columns">
                        <i style="color: #ff0000" class="general foundicon-remove remove-condition" data-bind="click:$parent.removeCondition"></i>
                    </div>
                    <!-- /ko -->

                </div>
                <!-- /ko -->
            </div>
        </div>

    </script>

    <script type="text/html" id="operation-template">
        <div class="row collapse">
            <div class="columns logic-toggler">
                <!-- ko if: $parent.groups && $parent.groups.indexOf($data) > 0 -->
                <div class="logic-wrapper">
                    <span data-bind="text: logic" class="logic-text label secondary"></span>
                    <select class="logic-selection" data-bind="options:$parents[level].arithmeticOperations, optionsCaption:'logic', value: logic"></select>
                </div>
                <!-- /ko -->
            </div>
            <div class="operation-group columns">
                <div class="row collapse">
                    <div class="small-10 columns" data-bind="comboBox :{selectedValue: prop, options:$parents[level].properties,optionsCaption:'choose Property'}">
                        
                    </div>
                    <div class="small-2 columns">
                        <i class="general foundicon-remove remove-condition" data-bind="click:$parent.removeCondition"></i>
                    </div>
                </div>
            </div>
        </div>
    </script>


    

    

        <script type="text/javascript" src="content/js/utils.js"></script>
    <script type="text/javascript" src="content/js/lib/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="content/js/lib/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="content/js/lib/d3.v3.js"></script>

    
    <script type="text/javascript" src="content/js/sortable.js"></script>

    <script type="text/javascript" src="content/js/lib/knockout-2.2.1.js"></script>
    <script type="text/javascript" src="content/js/lib/helpers/ko.extensions.js"></script>
    <script type="text/javascript" src="content/js/lib/helpers/ko.custombindinghandlers.js"></script>

    <script type="text/javascript" src="content/js/lib/underscore-min.js"></script>
    <script type="text/javascript" src="content/foundation/js/foundation/foundation.js"></script>
    <script type="text/javascript" src="content/foundation/js/foundation/foundation.topbar.js"></script>

    <script type="text/javascript" src="content/js/models/axis.js"></script>
    <script type="text/javascript" src="content/js/models/dots.js"></script>
    <script type="text/javascript" src="content/js/models/labels.js"></script>
    <script type="text/javascript" src="content/js/models/lines.js"></script>
    <script type="text/javascript" src="content/js/models/area.js"></script>
    <script type="text/javascript" src="content/js/models/tooltip.js"></script>
    <script type="text/javascript" src="content/js/charts/linechart.js"></script>
    <script type="text/javascript" src="content/js/charts/areachart.js"></script>

    <script type="text/javascript" src="content/js/segment.js"></script>
    <script type="text/javascript" src="content/js/charts/pie.js"></script>

    <script type="text/javascript" src="content/js/charts/barchart.js"></script>
    <script type="text/javascript" src="content/js/charts/scatterplot.js"></script>
   
    <script type="text/javascript" src="content/js/tempdata.js"></script>
       <script type="text/javascript" src="content/js/segment.js"></script>
     <script type="text/javascript" src="content/js/segmentprocessor.js"></script>

    <script type="text/javascript">
        (function (root) {
            window.segmentProcessor = new SegmentProcessor();
            ko.applyBindings(window.segmentProcessor, document.getElementById('segmentProcessor'));
        })(this);
    </script>
    <span id="lid" style="font-size:12px; font-family: arial; display:none"></span>
</body>
</html>
